'use strict';const _0xd3fe=['queryByAdvancedFilter','map','queryById','remove','Routine','2xOaHJL','retrieveList','743189cyimIS','1IDwuUJ','1303Aahxua','646792dIaeNx','../errors/errors','mapFavouriteEntity','deleteByFilter','619sFxgMn','Favourite','exports','all','create','mapRoutineEntity','categoryId','1035026dwqyRD','content','1UDSOyM','Category','14021jVcIVJ','2IyZJiJ','75atlqOm','Routine\x20id\x20','Category\x20id\x20','244037oZEmzi','483282CJVWcs','\x20not\x20found'];function _0x2584(_0x33163b,_0x19adf4){_0x33163b=_0x33163b-0x1a4;let _0xd3fe85=_0xd3fe[_0x33163b];return _0xd3fe85;}const _0x3e6ec5=_0x2584;(function(_0x4550f4,_0xead910){const _0x3b4976=_0x2584;while(!![]){try{const _0x23ba4c=-parseInt(_0x3b4976(0x1b2))*-parseInt(_0x3b4976(0x1ae))+parseInt(_0x3b4976(0x1bf))+-parseInt(_0x3b4976(0x1be))*parseInt(_0x3b4976(0x1c3))+parseInt(_0x3b4976(0x1bc))*-parseInt(_0x3b4976(0x1ab))+parseInt(_0x3b4976(0x1a9))*parseInt(_0x3b4976(0x1bd))+-parseInt(_0x3b4976(0x1af))*parseInt(_0x3b4976(0x1ad))+-parseInt(_0x3b4976(0x1ba))*-parseInt(_0x3b4976(0x1b3));if(_0x23ba4c===_0xead910)break;else _0x4550f4['push'](_0x4550f4['shift']());}catch(_0x5f546c){_0x4550f4['push'](_0x4550f4['shift']());}}}(_0xd3fe,0x82a5f));const {RepositoryName,RepositoryFactory}=require('../repository/RepositoryFactory'),{ModelMapper}=require('./ModelMapper'),{NotFoundError}=require(_0x3e6ec5(0x1c0));async function ensureCategory(_0x4a75b3){const _0x191817=_0x3e6ec5,_0x181862=RepositoryFactory[_0x191817(0x1a6)](RepositoryName[_0x191817(0x1ac)]);let _0x1d2f47=await _0x181862[_0x191817(0x1b7)](_0x4a75b3);if(!_0x1d2f47)throw new NotFoundError([_0x191817(0x1b1)+_0x4a75b3+_0x191817(0x1b4)]);return _0x1d2f47;}async function ensureRoutine(_0x38d768){const _0x41a933=_0x3e6ec5,_0x1dd230=RepositoryFactory[_0x41a933(0x1a6)](RepositoryName[_0x41a933(0x1b9)]);let _0x42f69c=await _0x1dd230[_0x41a933(0x1b7)](_0x38d768);if(!_0x42f69c)throw new NotFoundError([_0x41a933(0x1b0)+_0x38d768+'\x20not\x20found']);return _0x42f69c;}async function deepMapFavourite(_0x561915){const _0x2ecde7=_0x3e6ec5,_0x2e7a22=await ensureRoutine(_0x561915['routineId']);let _0x290773;if(_0x2e7a22['categoryId'])_0x290773=await ensureCategory(_0x2e7a22[_0x2ecde7(0x1a8)]);return ModelMapper[_0x2ecde7(0x1c1)](_0x561915,ModelMapper[_0x2ecde7(0x1a7)](_0x2e7a22,undefined,_0x290773));}module[_0x3e6ec5(0x1a4)]['add']=async(_0x10414f,_0x220575)=>{const _0x31bf85=_0x3e6ec5;await ensureRoutine(_0x220575);const _0x5e992f=RepositoryFactory[_0x31bf85(0x1a6)](RepositoryName[_0x31bf85(0x1c4)]);await _0x5e992f['insert']({'userId':_0x10414f['id'],'routineId':_0x220575});},module[_0x3e6ec5(0x1a4)][_0x3e6ec5(0x1b8)]=async(_0x401c5e,_0x714100)=>{const _0x10a6b5=_0x3e6ec5;await ensureRoutine(_0x714100);const _0x365d27=RepositoryFactory[_0x10a6b5(0x1a6)](RepositoryName[_0x10a6b5(0x1c4)]);await _0x365d27[_0x10a6b5(0x1c2)]({'userId':_0x401c5e['id'],'routineId':_0x714100});},module[_0x3e6ec5(0x1a4)][_0x3e6ec5(0x1bb)]=async(_0x314da9,_0x5d4117,_0x1a0cc2,_0x3d535c,_0x2458b3)=>{const _0x51b104=_0x3e6ec5,_0x544711={'userId':_0x314da9['id']},_0x5b9e36=RepositoryFactory[_0x51b104(0x1a6)](RepositoryName['Favourite']);let _0x5c5e89=await _0x5b9e36[_0x51b104(0x1b5)](_0x544711,null,_0x5d4117,_0x1a0cc2,_0x3d535c,_0x2458b3);return _0x5c5e89[_0x51b104(0x1aa)]=await Promise[_0x51b104(0x1a5)](_0x5c5e89[_0x51b104(0x1aa)][_0x51b104(0x1b6)](async _0x1d76bf=>{return await deepMapFavourite(_0x1d76bf);})),_0x5c5e89;};