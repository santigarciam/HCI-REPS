'use strict';const _0x43a6=['add','updateRoutineDto','sportId','\x20not\x20found','Routine','377071rlMzYN','retrieveSportList','1sULids','User\x20is\x20not\x20the\x20owner\x20of\x20routine\x20id\x20','retrieveUserList','mapSportEntity','insert','addSport','deleteById','category','../utils/PagedResult','retrieveList','deleteByFilter','412463nezLgF','474760udDpnD','User\x20id\x20','queryByAdvancedFilter','modify','Routine\x20id\x20','userId','1UdFEoz','removeSport','346899hPJuPx','mapCategoryEntity','mapRoutineDto','mapPublicUserEntity','exports','9503PHbaxN','../repository/RepositoryFactory','927kdcvad','categoryId','retrieve','difficulty','641591PcwDEE','content','map','2xpADii','User','all','65bCgroe','isPublic','queryById','RoutineSport','Category','Sport\x20id\x20','update','create','Category\x20id\x20','../errors/errors','473pyzSBH'];const _0x3987bc=_0x1ef0;(function(_0x218f32,_0x1ddefa){const _0x2009ff=_0x1ef0;while(!![]){try{const _0x14332c=parseInt(_0x2009ff(0x80))*parseInt(_0x2009ff(0x8c))+parseInt(_0x2009ff(0xa9))*-parseInt(_0x2009ff(0x9e))+-parseInt(_0x2009ff(0x89))*parseInt(_0x2009ff(0x9c))+-parseInt(_0x2009ff(0xb0))*-parseInt(_0x2009ff(0x7b))+-parseInt(_0x2009ff(0x96))*-parseInt(_0x2009ff(0x82))+parseInt(_0x2009ff(0x86))+-parseInt(_0x2009ff(0xaa));if(_0x14332c===_0x1ddefa)break;else _0x218f32['push'](_0x218f32['shift']());}catch(_0x3741e9){_0x218f32['push'](_0x218f32['shift']());}}}(_0x43a6,0x6275b));function _0x1ef0(_0x560892,_0x49e75e){_0x560892=_0x560892-0x7b;let _0x43a6b5=_0x43a6[_0x560892];return _0x43a6b5;}const {RepositoryName,RepositoryFactory}=require(_0x3987bc(0x81)),{ModelMapper}=require('./ModelMapper'),{PagedResult}=require(_0x3987bc(0xa6)),{NotFoundError,ForbiddenError}=require(_0x3987bc(0x95));async function ensureRoutine(_0x42396f,_0x302b3a,_0xad897c=!![]){const _0x508707=_0x3987bc,_0x24f6cc=RepositoryFactory[_0x508707(0x93)](RepositoryName[_0x508707(0x9b)]);let _0x18f1ee=await _0x24f6cc[_0x508707(0x8e)](_0x302b3a);if(!_0x18f1ee)throw new NotFoundError([_0x508707(0xae)+_0x302b3a+_0x508707(0x9a)]);if(_0xad897c&&_0x18f1ee[_0x508707(0xaf)]!==_0x42396f['id'])throw new ForbiddenError([_0x508707(0x9f)+_0x302b3a]);return _0x18f1ee;}async function ensureCategory(_0x2346f6){const _0x5befd7=_0x3987bc,_0x597f1a=RepositoryFactory[_0x5befd7(0x93)](RepositoryName[_0x5befd7(0x90)]);let _0x17d489=await _0x597f1a['queryById'](_0x2346f6);if(!_0x17d489)throw new NotFoundError([_0x5befd7(0x94)+_0x2346f6+_0x5befd7(0x9a)]);return _0x17d489;}async function ensureUser(_0x285a1d){const _0x33b919=_0x3987bc,_0x35646b=RepositoryFactory[_0x33b919(0x93)](RepositoryName[_0x33b919(0x8a)]);let _0x5a007b=await _0x35646b[_0x33b919(0x8e)](_0x285a1d);if(!_0x5a007b)throw new NotFoundError([_0x33b919(0xab)+_0x285a1d+'\x20not\x20found']);return _0x5a007b;}async function ensureSport(_0x277b32){const _0x31e064=_0x3987bc,_0x4974ed=RepositoryFactory[_0x31e064(0x93)](RepositoryName['Sport']);let _0x5be9dc=await _0x4974ed[_0x31e064(0x8e)](_0x277b32);if(!_0x5be9dc)throw new NotFoundError([_0x31e064(0x91)+_0x277b32+_0x31e064(0x9a)]);return _0x5be9dc;}async function deepMapRoutine(_0x1c437e,_0x4218e6,_0x7723fd,_0x35b09d=!![]){const _0x2322cf=_0x3987bc;!_0x4218e6&&_0x1c437e[_0x2322cf(0x83)]&&(_0x4218e6=await ensureCategory(_0x1c437e[_0x2322cf(0x83)]));if(!_0x7723fd&&_0x35b09d){const _0x1e7a9b=RepositoryFactory[_0x2322cf(0x93)](RepositoryName[_0x2322cf(0x8a)]);_0x7723fd=await _0x1e7a9b[_0x2322cf(0x8e)](_0x1c437e['userId']);if(!_0x7723fd)throw new NotFoundError([_0x2322cf(0xab)+_0x1c437e['userId']+_0x2322cf(0x9a)]);}return ModelMapper['mapRoutineEntity'](_0x1c437e,_0x35b09d?ModelMapper[_0x2322cf(0x7e)](_0x7723fd):undefined,_0x4218e6?ModelMapper[_0x2322cf(0x7c)](_0x4218e6):undefined);}async function deepMapRoutineSport(_0xb5863d){const _0x12eee5=_0x3987bc,_0x1cd4a3=RepositoryFactory[_0x12eee5(0x93)](RepositoryName['Sport']),_0x21c8ed=await _0x1cd4a3[_0x12eee5(0x8e)](_0xb5863d[_0x12eee5(0x99)]);return ModelMapper[_0x12eee5(0xa1)](_0x21c8ed);}module['exports'][_0x3987bc(0x97)]=async(_0x1b9399,_0x738e23)=>{const _0x12ddf3=_0x3987bc;let _0x47ad90;_0x738e23[_0x12ddf3(0xa5)]&&(_0x47ad90=await ensureCategory(_0x738e23[_0x12ddf3(0xa5)]['id']));const _0x480573=ModelMapper[_0x12ddf3(0x7d)](_0x738e23,_0x1b9399['id']),_0xc6cad2=RepositoryFactory['create'](RepositoryName[_0x12ddf3(0x9b)]),_0x549b9a=await _0xc6cad2[_0x12ddf3(0xa2)](_0x480573);return await deepMapRoutine(_0x549b9a,_0x47ad90,_0x1b9399,![]);},module['exports'][_0x3987bc(0xad)]=async(_0x2579d9,_0x5ee1a3,_0x419a31)=>{const _0x4be781=_0x3987bc;let _0x171b5f=await ensureRoutine(_0x2579d9,_0x5ee1a3),_0x4193cb;_0x419a31[_0x4be781(0xa5)]&&_0x171b5f[_0x4be781(0x83)]!==_0x419a31['category']['id']&&(_0x4193cb=ensureCategory(_0x419a31[_0x4be781(0xa5)]['id']));ModelMapper[_0x4be781(0x98)](_0x171b5f,_0x419a31);const _0x3624a9=RepositoryFactory[_0x4be781(0x93)](RepositoryName['Routine']);return await _0x3624a9[_0x4be781(0x92)](_0x171b5f),await deepMapRoutine(_0x171b5f,_0x4193cb,_0x2579d9,![]);},module['exports']['remove']=async(_0x1048b6,_0x39a2dd)=>{const _0x567559=_0x3987bc;await ensureRoutine(_0x1048b6,_0x39a2dd);const _0x138cb6=RepositoryFactory[_0x567559(0x93)](RepositoryName[_0x567559(0x9b)]);await _0x138cb6[_0x567559(0xa4)](_0x39a2dd);},module['exports'][_0x3987bc(0x84)]=async(_0x917cf1,_0x3d7da5)=>{const _0xf1c3a6=_0x3987bc,_0x511b7e=await ensureRoutine(_0x917cf1,_0x3d7da5,![]);if(!_0x511b7e[_0xf1c3a6(0x8d)]&&_0x511b7e[_0xf1c3a6(0xaf)]!==_0x917cf1['id'])throw new ForbiddenError(['User\x20is\x20not\x20the\x20owner\x20of\x20routine\x20id\x20'+_0x3d7da5]);return await deepMapRoutine(_0x511b7e);},module['exports'][_0x3987bc(0xa7)]=async(_0x35b69c,_0x522a2e,_0x14d124,_0x2980f0,_0x2b2cad,_0x3e700a,_0x83429a,_0x50a298,_0x4e675f)=>{const _0x4d6cc5=_0x3987bc;let _0x10328b={'isPublic':!![]};_0x35b69c&&(await ensureCategory(_0x35b69c),_0x10328b[_0x4d6cc5(0x83)]=_0x35b69c);_0x522a2e&&(await ensureUser(_0x522a2e),_0x10328b['userId']=_0x522a2e);if(_0x14d124)_0x10328b[_0x4d6cc5(0x85)]=_0x14d124;if(_0x2980f0)_0x10328b['averageRating']=_0x2980f0;const _0x4ba0ae=_0x2b2cad?{'column':'name','value':_0x2b2cad}:null,_0x526b69=RepositoryFactory[_0x4d6cc5(0x93)](RepositoryName['Routine']);let _0xbe3586=await _0x526b69[_0x4d6cc5(0xac)](_0x10328b,_0x4ba0ae,_0x3e700a,_0x83429a,_0x50a298,_0x4e675f);return _0xbe3586[_0x4d6cc5(0x87)]=await Promise[_0x4d6cc5(0x8b)](_0xbe3586[_0x4d6cc5(0x87)]['map'](async _0x11f5e9=>{return await deepMapRoutine(_0x11f5e9);})),_0xbe3586;},module['exports'][_0x3987bc(0xa0)]=async(_0x241b8e,_0x361cb8,_0xa42227,_0x5e9f68,_0x33e4cb,_0x232fe3,_0x11a155,_0x2b0cdc)=>{const _0x562892=_0x3987bc;let _0xaa2bdc={'userId':_0x361cb8};_0x241b8e['id']!==_0x361cb8&&(await ensureUser(_0x361cb8),_0xaa2bdc[_0x562892(0x8d)]=!![]);if(_0xa42227)_0xaa2bdc['difficulty']=_0xa42227;const _0x1c4c0c=_0x5e9f68?{'column':'name','value':_0x5e9f68}:null,_0x27fde4=RepositoryFactory[_0x562892(0x93)](RepositoryName[_0x562892(0x9b)]);let _0x57b567=await _0x27fde4[_0x562892(0xac)](_0xaa2bdc,_0x1c4c0c,_0x33e4cb,_0x232fe3,_0x11a155,_0x2b0cdc);return _0x57b567[_0x562892(0x87)]=await Promise[_0x562892(0x8b)](_0x57b567[_0x562892(0x87)][_0x562892(0x88)](async _0x8a0e97=>{return await deepMapRoutine(_0x8a0e97,undefined,undefined,![]);})),_0x57b567;},module[_0x3987bc(0x7f)][_0x3987bc(0xa3)]=async(_0x2b3c8d,_0x168e30,_0x40a218)=>{const _0x4834e8=_0x3987bc;await ensureRoutine(_0x2b3c8d,_0x168e30),await ensureSport(_0x40a218);const _0xd93e37=RepositoryFactory['create'](RepositoryName['RoutineSport']);await _0xd93e37[_0x4834e8(0xa2)]({'routineId':_0x168e30,'sportId':_0x40a218});},module[_0x3987bc(0x7f)][_0x3987bc(0xb1)]=async(_0x160515,_0x2a7ce6,_0x253e66)=>{const _0x2c8191=_0x3987bc;await ensureRoutine(_0x160515,_0x2a7ce6),await ensureSport(_0x253e66);const _0x5ae622=RepositoryFactory['create'](RepositoryName[_0x2c8191(0x8f)]);await _0x5ae622[_0x2c8191(0xa8)]({'routineId':_0x2a7ce6,'sportId':_0x253e66});},module[_0x3987bc(0x7f)][_0x3987bc(0x9d)]=async(_0x37ab0c,_0x3f9a19,_0x345660,_0x5263ef,_0x1201a4,_0x483dc7)=>{const _0x191666=_0x3987bc;await ensureRoutine(_0x37ab0c,_0x3f9a19);const _0x1a2864={'routineId':_0x3f9a19},_0x28445b=RepositoryFactory[_0x191666(0x93)](RepositoryName[_0x191666(0x8f)]);let _0x2a34e3=await _0x28445b[_0x191666(0xac)](_0x1a2864,null,_0x345660,_0x5263ef,_0x1201a4,_0x483dc7);return _0x2a34e3['content']=await Promise[_0x191666(0x8b)](_0x2a34e3[_0x191666(0x87)][_0x191666(0x88)](async _0x1ab245=>{return await deepMapRoutineSport(_0x1ab245);})),_0x2a34e3;};